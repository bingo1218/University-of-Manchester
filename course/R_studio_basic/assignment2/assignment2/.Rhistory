size = 2) +
geom_boxplot(alpha = .5) +
scale_fill_brewer(palette = "Set1") +
guides(colour = 'none') +
theme_classic() +
theme(axis.text.x = element_text(angle = 0, vjust = 5, hjust = .5)) +
labs(title = "Response Time in Different Conditions",
x = "condtion",
y = "Response Time (ms)") +
stat_compare_means(method = "anova")
plot3_41
plot3_1
knitr::opts_chunk$set(echo = TRUE)
set.seed(123)
plot3_1 <- Q3_tided %>%
ggplot(aes(x = Prime:Target, y = RT)) +
geom_violin(aes(fill = Prime:Target),
trim = FALSE,
width = 1,
alpha = 0.4) +
geom_jitter(shape = 21,
width = .2,
alpha = 2,
size = 2) +
geom_boxplot(alpha = .5) +
scale_fill_brewer(palette = "Set1") +
guides(colour = 'none') +
theme_classic() +
theme(axis.text.x = element_text(angle = 0, vjust = 5, hjust = .5)) +
labs(title = "Response Time in Different Conditions",
x = "condtion",
y = "Response Time (ms)") +
stat_compare_means(method = "anova")
plot3_1
set.seed(123)
plot3_1 <- Q3_tided %>%
ggplot(aes(x = Prime:Target, y = RT)) +
geom_violin(aes(fill = Prime:Target),
trim = FALSE,
width = 1,
alpha = 0.4) +
geom_jitter(shape = 21,
width = .2,
alpha = 2,
size = 2,
color = Prime:Target) +
geom_boxplot(alpha = .5) +
scale_fill_brewer(palette = "Set1") +
guides(colour = 'none') +
theme_classic() +
theme(axis.text.x = element_text(angle = 0, vjust = 5, hjust = .5)) +
labs(title = "Response Time in Different Conditions",
x = "condtion",
y = "Response Time (ms)") +
stat_compare_means(method = "anova")
set.seed(123)
plot3_1 <- Q3_tided %>%
ggplot(aes(x = Prime:Target, y = RT)) +
geom_violin(aes(fill = Prime:Target),
trim = FALSE,
width = 1,
alpha = 0.4) +
geom_jitter(aes(fill = Prime:Target),
shape = 21,
width = .2,
alpha = 2,
size = 2) +
geom_boxplot(alpha = .5) +
scale_fill_brewer(palette = "Set1") +
guides(colour = 'none') +
theme_classic() +
theme(axis.text.x = element_text(angle = 0, vjust = 5, hjust = .5)) +
labs(title = "Response Time in Different Conditions",
x = "condtion",
y = "Response Time (ms)") +
stat_compare_means(method = "anova")
plot3_1
set.seed(123)
plot3_1 <- Q3_tided %>%
ggplot(aes(x = Prime:Target, y = RT)) +
geom_violin(aes(fill = Prime:Target),
trim = FALSE,
width = 1,
alpha = 0.4) +
geom_jitter(aes(fill = Prime:Target),
shape = 21,
width = .2,
alpha = 2,
size = 2) +
geom_boxplot(aes(fill = Prime:Target), alpha = .5) +
scale_fill_brewer(palette = "Set1") +
guides(colour = 'none') +
theme_classic() +
theme(axis.text.x = element_text(angle = 0, vjust = 5, hjust = .5)) +
labs(title = "Response Time in Different Conditions",
x = "condtion",
y = "Response Time (ms)") +
stat_compare_means(method = "anova")
plot3_1
set.seed(123)
plot3_1 <- Q3_tided %>%
ggplot(aes(x = Prime:Target, y = RT)) +
geom_violin(aes(fill = Prime:Target),
trim = FALSE,
width = 1,
alpha = 0.4) +
geom_jitter(aes(fill = Prime:Target),
shape = 21,
width = .2,
alpha = 1,
size = 2) +
geom_boxplot(aes(fill = Prime:Target), alpha = .5) +
scale_fill_brewer(palette = "Set1") +
guides(colour = 'none') +
theme_classic() +
theme(axis.text.x = element_text(angle = 0, vjust = 5, hjust = .5)) +
labs(title = "Response Time in Different Conditions",
x = "condtion",
y = "Response Time (ms)") +
stat_compare_means(method = "anova")
plot3_1
set.seed(123)
plot3_1 <- Q3_tided %>%
ggplot(aes(x = Prime:Target, y = RT)) +
geom_violin(aes(fill = Prime:Target),
trim = FALSE,
width = 1,
alpha = 0.4) +
geom_jitter(aes(fill = Prime:Target),
shape = 21,
width = .2,
alpha = 0.5,
size = 2) +
geom_boxplot(aes(fill = Prime:Target), alpha = .5) +
scale_fill_brewer(palette = "Set1") +
guides(colour = 'none') +
theme_classic() +
theme(axis.text.x = element_text(angle = 0, vjust = 5, hjust = .5)) +
labs(title = "Response Time in Different Conditions",
x = "condtion",
y = "Response Time (ms)") +
stat_compare_means(method = "anova")
plot3_1
?stat_compare_means
set.seed(123)
plot3_1 <- Q3_tided %>%
ggplot(aes(x = Prime:Target, y = RT)) +
geom_violin(aes(fill = Prime:Target),
trim = FALSE,
width = 1,
alpha = 0.4) +
geom_jitter(aes(fill = Prime:Target),
shape = 21,
width = .2,
alpha = 0.5,
size = 2) +
geom_boxplot(aes(fill = Prime:Target), alpha = .5) +
scale_fill_brewer(palette = "Set1") +
guides(colour = 'none') +
theme_classic() +
theme(axis.text.x = element_text(angle = 0, vjust = 5, hjust = .5)) +
labs(title = "Response Time in Different Conditions",
x = "condtion",
y = "Response Time (ms)"))
set.seed(123)
plot3_1 <- Q3_tided %>%
ggplot(aes(x = Prime:Target, y = RT)) +
geom_violin(aes(fill = Prime:Target),
trim = FALSE,
width = 1,
alpha = 0.4) +
geom_jitter(aes(fill = Prime:Target),
shape = 21,
width = .2,
alpha = 0.5,
size = 2) +
geom_boxplot(aes(fill = Prime:Target), alpha = .5) +
scale_fill_brewer(palette = "Set1") +
guides(colour = 'none') +
theme_classic() +
theme(axis.text.x = element_text(angle = 0, vjust = 5, hjust = .5)) +
labs(title = "Response Time in Different Conditions",
x = "condtion",
y = "Response Time (ms)")
plot3_1
Q3_tidied <- Q3_longer %>%
separate(col = "valence", into = c("Prime", "Target"),
sep = "_") %>%
mutate(Prime = factor(Prime), Target = factor(Target))
Q3_tidied
Q3_summarised <- Q3_tidied %>%
group_by(Prime, Target) %>%
summarise(mean = mean(RT), sd = sd (RT), median_RT = median(RT), n())
knitr::kable(
Q3_summarised,
caption = "The profile of response time in four conditions", col.names = c('Prime', 'Target', 'mean (ms)', 'SD (ms)', 'median (ms)', 'N'), digits = 0, format.args = list(big.mark = ",",
scientific = FALSE), align = "llllll")
plot3_1 <- Q3_tidied %>%
ggplot(aes(y = RT, colour = Expectation:Target)) +
geom_density(alpha = 0.4, linetype = 1) +
coord_flip() +
scale_colour_brewer(palette = "Dark2") +
theme_tufte() +
theme(plot.title = element_text(hjust = 0.5,
face = "bold",
size = 20)) +
theme(axis.line = element_line(colour = "grey50")) +
theme(axis.title = element_text(size = 15)) +
labs(title = "Reaction Time Distrubution Per Condition",
y = "Reaction Time (s)",
x = "Density")
plot3_1 <- Q3_tidied %>%
ggplot(aes(y = RT, colour = Prime:Target)) +
geom_density(alpha = 0.4, linetype = 1) +
coord_flip() +
scale_colour_brewer(palette = "Set1") +
theme_tufte() +
theme(plot.title = element_text(hjust = 0.5,
face = "bold",
size = 20)) +
theme(axis.line = element_line(colour = "grey50")) +
theme(axis.title = element_text(size = 15)) +
labs(title = "Reaction Time Distrubution Per Condition",
y = "Reaction Time (s)",
x = "Density")
plot3_1 <- Q3_tidied %>%
ggplot(aes(y = RT, colour = Prime:Target)) +
geom_density(alpha = 0.4, linetype = 1) +
coord_flip() +
scale_colour_brewer(palette = "Set1") +
theme_classic() +
theme(plot.title = element_text(hjust = 0.5,
face = "bold",
size = 20)) +
theme(axis.line = element_line(colour = "grey50")) +
theme(axis.title = element_text(size = 15)) +
labs(title = "Reaction Time Distrubution Per Condition",
y = "Reaction Time (s)",
x = "Density")
plot3
plot3_1
plot3_1 <- Q3_tidied %>%
ggplot(aes(y = RT, colour = Prime:Target)) +
geom_density(alpha = 0.4, linetype = 1) +
coord_flip() +
scale_colour_brewer(palette = "Set1") +
facet_wrap(~Prime:Target)
theme_classic() +
theme(plot.title = element_text(hjust = 0.5,
face = "bold",
size = 20)) +
theme(axis.line = element_line(colour = "grey50")) +
theme(axis.title = element_text(size = 15)) +
labs(title = "Reaction Time Distrubution Per Condition",
y = "Reaction Time (s)",
x = "Density")
plot3_1
plot3_1 <- Q3_tidied %>%
ggplot(aes(y = RT, colour = Prime:Target)) +
geom_density(alpha = 0.4, linetype = 1) +
coord_flip() +
scale_colour_brewer(palette = "Set1") +
facet_wrap(~Prime:Target)+
theme_classic() +
theme(plot.title = element_text(hjust = 0.5,
face = "bold",
size = 20)) +
theme(axis.line = element_line(colour = "grey50")) +
theme(axis.title = element_text(size = 15)) +
labs(title = "Reaction Time Distrubution Per Condition",
y = "Reaction Time (s)",
x = "Density")
plot3_1
plot3_1 <- Q3_tidied %>%
ggplot(aes(y = RT, colour = Prime:Target)) +
geom_density(alpha = 0.4, linetype = 1) +
coord_flip() +
scale_colour_brewer(palette = "Set1") +
facet_wrap(~Prime:Target)+
theme_classic() +
labs(title = "Reaction Time Distrubution Per Condition",
y = "Reaction Time (s)",
x = "Density")
plot3_1
plot3_1 <- Q3_tidied %>%
ggplot(aes(y = RT, colour = Prime:Target)) +
geom_density(alpha = 0.4, linetype = 1) +
scale_colour_brewer(palette = "Set1") +
facet_wrap(~Prime:Target)+
theme_classic() +
labs(title = "Reaction Time Distrubution Per Condition",
y = "Reaction Time (s)",
x = "Density")
plot3_1
plot3_1 <- Q3_tidied %>%
ggplot(aes(y = RT, colour = Prime:Target)) +
geom_density(alpha = 0.4, linetype = 1) +
coord_flip() +
scale_colour_brewer(palette = "Set1") +
facet_wrap(~Prime:Target)+
theme_classic() +
labs(title = "Reaction Time Distrubution Per Condition",
y = "Reaction Time (s)",
x = "Density")
plot3_1
set.seed(123)
plot3_1 <- Q3_tided %>%
ggplot(aes(x = Prime:Target, y = RT)) +
geom_violin(aes(fill = Prime:Target),
trim = FALSE,
width = 1,
alpha = 0.4) +
geom_jitter(aes(fill = Prime:Target),
shape = 21,
width = .2,
alpha = 0.5,
size = 2) +
geom_boxplot(aes(fill = Prime:Target), alpha = .5) +
scale_fill_brewer(palette = "Set1") +
guides(colour = 'none') +
theme_classic() +
theme(axis.text.x = element_text(angle = 0, vjust = 5, hjust = .5)) +
labs(title = "Response Time in Different Conditions",
x = "Priming x Target",
y = "Response Time (ms)")
plot3_2
plot3_1 <- Q3_tidied %>%
ggplot(aes(y = RT, colour = Prime:Target)) +
geom_density(alpha = 0.4, linetype = 1) +
coord_flip() +
scale_colour_brewer(palette = "Set1") +
facet_wrap(~Prime:Target)+
theme_classic() +
labs(title = "Reaction Time Distrubution Per Condition",
y = "Reaction Time (s)",
x = "Density")
plot3_1
set.seed(123)
plot3_2 <- Q3_tided %>%
ggplot(aes(x = Prime:Target, y = RT)) +
geom_violin(aes(fill = Prime:Target),
trim = FALSE,
width = 1,
alpha = 0.4) +
geom_jitter(aes(fill = Prime:Target),
shape = 21,
width = .2,
alpha = 0.5,
size = 2) +
geom_boxplot(aes(fill = Prime:Target), alpha = .5) +
scale_fill_brewer(palette = "Set1") +
guides(colour = 'none') +
theme_classic() +
theme(axis.text.x = element_text(angle = 0, vjust = 5, hjust = .5)) +
labs(title = "Response Time in Different Conditions",
x = "Priming x Target",
y = "Response Time (ms)")
plot3_2
model3 <- aov_4(RT ~ Prime * Target + (1 + Prime * Target | participant), data = Q3_tidied, na.rm = TRUE)
model3 <- aov_4(RT ~ Prime * Target + (1 + Prime * Target | participant), data = Q3_tidied, na.rm = TRUE)
anova(model3)
emmeans(model_subjects, pairwise ~ Context * Sentence, adjust = "none")
emmeans(model3, pairwise ~ rime * Target, adjust = "none")
emmeans(model3, pairwise ~ Prime * Target, adjust = "none")
model3 <- aov_4(RT ~ Prime * Target + (1 + Prime * Target | participant), data = Q3_tidied, na.rm = TRUE)
anova(model3)
summary(modeo3)
summary(model3)
View(model3)
(model3)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(afex)
library(emmeans)
library(knitr)
library(ggpubr)
library(ggridges)
library(car)
library(ggstatsplot)
library(rstatix)
library(broom)
Q1 <- read_csv("assignment_2_dataset_1.csv")
as_tibble(Q1)
head(Q1)
str(Q1)
Q1_tided <- Q1 %>%
mutate(condition = factor(condition)) %>%
rename(RT = response_time) %>%
mutate(condition = dplyr::recode(condition,
"condition_a" = "Normal",
"condition_b" = "Degrade"))
Normal_fil <- Q1_tided %>%
filter(condition == "Normal") %>%
select(RT) %>%
map(function(x) ifelse(((x-mean(x))/sd(x)) <= 3, x, NA))
Degrade_fil <- Q1_tided %>%
filter(condition == "Degrade") %>%
select(RT) %>%
map(function(x) ifelse(((x-mean(x))/sd(x)) <= 3, x, NA))
Q1_fil <- Q1_tided
Q1_fil$RT <- append(unlist(Normal_fil, use.names = FALSE), unlist(Degrade_fil, use.names = FALSE))
Q1_fil%>% filter(!is.na(RT))
Q1_summarise <- Q1_fil %>%
group_by(condition) %>%
summarise(mean_RT = mean(RT),
sd_RT = sd(RT),
se = sd(RT) / sqrt(length(n)),
median_RT = median(RT),
max_RT = max(RT),
min_RT = min(RT),
quantile_RT25 = quantile(RT, 0.25),
quantile_RT75 = quantile(RT, 0.75),
var_RT = var(RT),
number = n())
Q2 <- read_csv("assignment_2_dataset_2.csv")
as_tibble(Q2)
head(Q2)
str(Q2)
Q2_tided <- Q2 %>%
mutate(condition = factor(condition)) %>%
rename(RT = response_time) %>%
mutate(condition = dplyr::recode(condition,
"condition_a" = "Normal",
"condition_b" = "Degrade"))
Normal_fil2 <- Q2_tided %>%
filter(condition == "Normal") %>%
select(RT) %>%
map(function(x) ifelse(((x-mean(x))/sd(x)) <= 3, x, NA))
Degrade_fil2 <- Q2_tided %>%
filter(condition == "Degrade") %>%
select(RT) %>%
map(function(x) ifelse(((x-mean(x))/sd(x)) <= 3, x, NA))
Q2_fil <- Q2_tided
Q2_fil$RT <- append(as.numeric(unlist(Normal_fil2)), as.numeric(unlist(Degrade_fil2)))
Q2_fil%>% filter(!is.na(RT))
Q2_summarise <- Q2_fil %>%
group_by(condition) %>%
summarise(mean_RT = mean(RT),
sd_RT = sd(RT),
se = sd(RT) / sqrt(length(n)),
median_RT = median(RT),
max_RT = max(RT),
min_RT = min(RT),
quantile_RT25 = quantile(RT, 0.25),
quantile_RT75 = quantile(RT, 0.75),
var_RT = var(RT),
number = n())
knitr::kable(
Q2_summarise,
caption = "Profile of reaction time (RT) in two conditions", col.names = c('condition', 'Mean(ms)', 'SD (ms)', 'SE (ms)', 'median (ms)', 'max (ms)', 'min (ms)', '25% quantile (ms)', '75% quantile (ms)', 'variance (ms)', 'N'), digits = 0, format.args = list(big.mark = ",",
scientific = FALSE), align = "lllllllllll")
# Fit the model, the covariate goes first
model2_nmt <- lm(RT ~ caffeine + condition, data = Q2_fil)
# Inspect the model diagnostic metrics
model2_nmt.metrics <- augment(model2_nmt) %>%
select(-.hat, -.sigma, -.fitted) # Remove details
head(model2_nmt.metrics, 3)
shapiro_test(model2_nmt.metrics$.resid)
model2_nmt.metrics %>% levene_test(.resid ~ condition)
model2_nmt.metrics %>%
filter(abs(.std.resid) > 3) %>%
as.data.frame()
set.seed(123)
plot2_1 <- ggplot(Q2_fil, aes(x = caffeine, y = RT,  colour = condition)) +
geom_point(size = 3, alpha = .9) +
geom_smooth(method = lm)+
labs(x = "Caffeine Comsuption (each day)",
y = "Responpse Time") +
theme_classic() +
theme(text = element_text(size = 11))
plot2_1
plot2_2 <- ggscatter(Q2_fil,
x = "caffeine",
y = "RT",
color = "condition",
add = "reg.line",
palette = "Set1")+
stat_regline_equation(
aes(label =  paste(..eq.label.., ..rr.label.., sep = "~~~~"),
color = condition))
plot2_2
model2_ancova <- aov_4(RT ~ caffeine + condition + (1 | participant), data = Q2_fil, factorize = FALSE)
anova(model2_ancova)
emmeans(model2_ancova, pairwise ~ condition)
contrasts(Q2_fil$condition)
model2_lm <- lm(RT ~ caffeine + condition, data = Q2_fil)
model2_lm
mean(Q2_fil$caffeine)
summary(model2_lm)
?fct_relevel
View(Q2_fil)
Q2_fil_test <- Q2_fil %>%
fct_relevel(f)
Q2_fil_test <- Q2_fil %>%
fct_relevel(condition)
Q2_fil_test <- Q2_fil %>%
fct_relevel(Q2_fil$condition)
Q2_fil_test <- Q2_fil %>%
fct_relevel(condition)
Q2_fil_test <- Q2_fil %>%
mutate(condition = fct_relevel(condition))
contrasts(Q2_fil_test$condition)
contrasts(Q2_fil$condition)
contrasts(Q2_fil_test$condition)
contrasts(Q2_fil_test$condition)
contrasts(Q2_fil$condition)
Q2_fil_test <- Q2_fil %>%
mutate(condition = fct_relevel(condition, c("Degrade", "Normal")))
contrasts(Q2_fil_test$condition)
contrasts(Q2_fil$condition)
model2_lm2 <- lm(RT ~ caffeine + condition, data = Q2_fil_test)
model2_lm2
