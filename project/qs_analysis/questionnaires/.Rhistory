knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
path <- 'D:\UoM\data\qs_data\Memory+and+Attention+-+pre-questionnaire_August+22,+2022_09.05\Memory and Attention - pre-questionnaire_August 22, 2022_09.05.xlsx'
path <- "D:\UoM\data\qs_data\Memory+and+Attention+-+pre-questionnaire_August+22,+2022_09.05\Memory and Attention - pre-questionnaire_August 22, 2022_09.05.xlsx"
qs <- read_xlsx("D:\UoM\data\qs_data\Memory+and+Attention+-+pre-questionnaire_August+22,+2022_09.05\Memory and Attention - pre-questionnaire_August 22, 2022_09.05.xlsx")
library(readxl)
Memory_and_Attention_pre_questionnaire_August_22_2022_09_05 <- read_excel("D:/UoM/data/qs_data/Memory+and+Attention+-+pre-questionnaire_August+22,+2022_09.05/Memory and Attention - pre-questionnaire_August 22, 2022_09.05.xlsx",
skip = 1)
View(Memory_and_Attention_pre_questionnaire_August_22_2022_09_05)
read_xlsx
file_path <- "D:/UoM/data/qs_data/Memory+and+Attention+-+pre-questionnaire_August+22,+2022_09.05/Memory and Attention - pre-questionnaire_August 22, 2022_09.05.xlsx"
qs <- read_xlsx(file_path)
View(qs)
qs_demographic <- qs %>%
select(Number)
View(qs_demographic)
qs <- read_xlsx(file_path,skip = 1)
18:55
qs <- read_xlsx(file_path,skip = 1)
qs_demographic <- qs%>%
select(18:55)
View(qs_demographic)
?read_xlsx
qs <- read_xlsx(file_path,skip = 2)
qs <- read_xlsx(file_path)
qs <- read_xlsx(file_path) %>%
filter(!row_number() %in% c(1))
qs_demographic <- qs%>%
select(18:55)
qs_demographic <- qs%>%
select(18:55)
qs <- read_xlsx(file_path) %>%
filter(!row_number() %in% c(1))
qs_demographic <- qs%>%
select(18:55)
View(qs_demographic)
subjects_number = [1002:1024]
subjects_number = 1002:1024
qs_demographic <- qs%>%
select(18:55) %>%
filter(Number = subjects_number)
qs_demographic <- qs%>%
select(18:55) %>%
filter(Number == subjects_number)
qs_demographic <- qs%>%
select(18:55) %>%
filter(Number %in% subjects_number)
eeptools
install.packages('eeptools')
library(eeptools)
qs_demographic <- qs%>%
select(18:55) %>%
filter(Number %in% subjects_number) %>%
mutate(age_n <- as.Date(Age))
as.Date(04/1998)
as.Date('04/1998')
age_calc('04/1998')
str(qs_demographic)
qs_demographic <- qs%>%
select(18:55) %>%
filter(Number %in% subjects_number) %>%
mutate(age_n <- as.Date(paste(Age,"-01",sep="")))
as.Date(paste('04/1998',"-01",sep="")
)
?as.date
?as.Date
?paste
paste('2009-01',"-01",sep = "-")
paste('2009-01',"-01",sep = "")
?as.Date
qs_demographic <- qs%>%
select(18:55) %>%
filter(Number %in% subjects_number) %>%
mutate(age_n <- as.Date(paste(Age,"/01",sep=""),"%d/%m/%y"))
qs_demographic <- qs%>%
select(18:55) %>%
filter(Number %in% subjects_number) %>%
mutate(age_n = as.Date(paste(Age,"/01",sep=""),"%d/%m/%y"))
qs_demographic <- qs%>%
select(18:55) %>%
filter(Number %in% subjects_number) %>%
mutate(age_n = as.Date(paste(Age,"/01",sep=""),"%m/%y/%d"))
paste('04/1998',"/01",sep="")
as.Date(paste('04/1998',"/01",sep=""),"%m/%y/%d")
as.Date(paste('04/1998',"/01",sep=""))
as.Date(paste('04/1998',"/01",sep=""),"%m/%Y/%d")
qs_demographic <- qs%>%
select(18:55) %>%
filter(Number %in% subjects_number) %>%
mutate(age_n = age_calc(as.Date(paste(Age,"/01",sep=""),"%m/%Y/%d")))
qs_demographic <- qs%>%
select(18:55) %>%
filter(Number %in% subjects_number) %>%
mutate(age_n = as.Date(paste(Age,"/01",sep=""),"%m/%Y/%d")) %>%
mutate(age_n = age_calc(age_n))
qs_demographic <- qs%>%
select(18:55) %>%
filter(Number %in% subjects_number) %>%
mutate(age_n = as.Date(paste(Age,"/01",sep=""),"%m/%Y/%d"))
age_calc('1998-04-01')
age_calc(as.date('1998-04-01'))
age_calc(as.Date('1998-04-01'))
age_calc(as.Date('1998-04-01'),units = "years")
?age_calc
qs_demographic <- qs%>%
select(18:55) %>%
filter(Number %in% subjects_number) %>%
mutate(age_n = as.Date(paste(Age,"/01",sep=""),"%m/%Y/%d"))%>%
mutate(age_n = age_calc(age_n,enddate(as.Date(2022-08-27)),units = "year"))
qs_demographic <- qs%>%
select(18:55) %>%
filter(Number %in% subjects_number) %>%
mutate(age_n = as.Date(paste(Age,"/01",sep=""),"%m/%Y/%d"))%>%
mutate(age_n = age_calc(age_n,enddate = as.Date(2022-08-27),units = "year"))
qs_demographic <- qs%>%
select(18:55) %>%
filter(Number %in% subjects_number) %>%
mutate(age_n = as.Date(paste(Age,"/01",sep=""),"%m/%Y/%d"))%>%
mutate(age_n = age_calc(age_n,enddate = as.Date('2022-08-27'),units = "year"))
subjects_number(-1009)
subjects_number <- 1002:1024
subjects_number(-1009)
subjects_number[-1009]
subjects_number <- [1002:1008, 1010:1024]
subjects_number <- c(1002:1008, 1010:1024)
qs_demographic <- qs%>%
select(18:55) %>%
filter(Number %in% subjects_number) %>%
mutate(age_n = as.Date(paste(Age,"/01",sep=""),"%m/%Y/%d"))%>%
mutate(age_n = age_calc(age_n,enddate = as.Date('2022-08-27'),units = "year"))
subjects_number <- c(1002:1008, 1010:1024)
qs_demographic <- qs%>%
select(18:55) %>%
filter(Number %in% subjects_number)
qs_demographic <- qs%>%
select(18:55) %>%
filter(Number %in% subjects_number) %>%
mutate(age_n = as.Date(paste(Age,"/01",sep=""),"%m/%Y/%d"))%>%
mutate(age_n = age_calc(age_n,enddate = as.Date('2022-08-27'),units = "year"))
qs_demographic <- qs%>%
select(18:55) %>%
filter(Number %in% subjects_number) %>%
mutate(age_n = as.Date(paste(Age,"/01",sep=""),"%m/%Y/%d"))%>%
mutate(age_n = age_calc(age_n,enddate = as.Date('2022-08-27'),units = "Year"))
qs_demographic <- qs%>%
select(18:55) %>%
filter(Number %in% subjects_number) %>%
mutate(age_n = as.Date(paste(Age,"/01",sep=""),"%m/%Y/%d"))%>%
mutate(age_n = age_calc(age_n,enddate = as.Date('2022-08-27'),units = "yeara"))
qs_demographic <- qs%>%
select(18:55) %>%
filter(Number %in% subjects_number) %>%
mutate(age_n = as.Date(paste(Age,"/01",sep=""),"%m/%Y/%d"))%>%
mutate(age_n = age_calc(age_n,enddate = as.Date('2022-08-27'),units = "years"))
qs_demographic_ageconvert <- qs%>%
select(18:55) %>%
filter(Number %in% subjects_number) %>%
mutate(age_n = as.Date(paste(Age,"/01",sep=""),"%m/%Y/%d"))%>%
mutate(age_n = age_calc(age_n,enddate = as.Date('2022-08-01'),units = "years"))
qs_demographic_noconvert <- qs%>%
select(18:55) %>%
filter(Number = 1009) %>%
mutate(age_n = Age)
qs_demographic_noconvert <- qs %>%
select(18:55) %>%
filter(Number == 1009) %>%
mutate(age_n = Age)
View(qs_demographic_noconvert)
qs_demographic <-  rbind (qs_demographic_ageconvert,qs_demographic_noconvert)
View(qs_demographic)
qs_demographic <-  rbind (qs_demographic_ageconvert,qs_demographic_noconvert) %>%
mutate(age = age_n) %>%
select(-c(Age,age_n))
qs_final[which(qs_demographic) == "Rarely/Never"] <- "1"；
qs_demographic[which(qs_demographic) == "Rarely/Never"] <- "1"；
qs_demographic[which(qs_demographic == "Rarely/Never")] <- "1"；
qs_demographic[qs_demographic == "Rarely/Never"] <- "1"
qs_demographic[qs_demographic == "Rarely/Never"] <- "1"
qs_demographic[qs_demographic == "Occasionally"] <- "2"
qs_demographic[qs_demographic == "Often"] <- "3"
qs_demographic[qs_demographic == "Almost Always/Always"] <- "4"
qs_demographic[] <- lapply(qs_demographic, function(x) as.numeric(as.character(qs_demographic[6:36])))
qs_demographic[6:36] <- lapply(qs_demographic, function(x) as.numeric(as.character(qs_demographic[6:36])))
qs_demographic[6:36] <- lapply(qs_demographic, function(x) as.numeric(qs_demographic[6:36]))
qs_demographic[6:36] <- lapply(qs_demographic[6:36], function(x) as.numeric(qs_demographic[6:36]))
qs_demographic[6:36] <- lapply(qs_demographic[6:36], function(x) as.numeric(x))
target_score <- total_score-ini_score
score_reverse <- function(ini_score,total_score){
target_score <- total_score-ini_score
return(target_score)
}
score_reverse(1,5)
score_reverse(2,5)
score_reverse(4,5)
score_reverse <- function(ini_score,total_score){
if(is.null(total_score))
total_score <- 5
target_score <- total_score-ini_score
return(target_score)
}
score_reverse <- 2
score_reverse <- function(ini_score,total_score){
if(is.null(total_score))
total_score <- 5
target_score <- total_score-ini_score
return(target_score)
}
score_reverse(2)
score_reverse <- function(ini_score,total_score){
if(missing(total_score))
total_score <- 5
target_score <- total_score-ini_score
return(target_score)
}
score_reverse(2)
score_reverse(1)
score_reverse(4)
qs_final <- qs_demographic %>%
mutate(BIS_Attention <- '5' + score_reverse('9') + '11' + score_reverse('20') + '28')
qs_final <- qs_demographic %>%
mutate(BIS_Attention <- `5` + score_reverse(`9`) + `11` + score_reverse(`20`) + `28`)
View(qs_final)
qs_final <- qs_demographic %>%
mutate(BIS_Attention = `5` + score_reverse(`9`) + `11` + score_reverse(`20`) + `28`)
qs_demographic[qs_demographic == "Rarely/Never"] <- "1"
qs_demographic[qs_demographic == "Occasionally"] <- "2"
qs_demographic[qs_demographic == "Often"] <- "3"
qs_demographic[qs_demographic == "Almost Always/Always"] <- "4"
qs_demographic[6:36] <- lapply(qs_demographic[6:36], function(x) as.numeric(x))
qs_final <- qs_demographic %>%
mutate(Attention = `5` + score_reverse(`9`) + `11` + score_reverse(`20`) + `28`,
CogInstab = `6`+`24`+`26`,
Motor = 	`2`+ `3` + `4` + `17` + `19` + `22` + `25`,
Persever = `16` + `21` + `23` + score_reverse(`30`),
SelfControl = score_reverse(`1`) + score_reverse(`7`) + score_reverse(`8`) + score_reverse(`12`) + score_reverse(`13`) + `14`,
CogCompl = score_reverse(`10`) + score_reverse(`15`) + `18` + `27` +  score_reverse(`29`)) %>%
mutate (BDI_attentional = Attention +CogInstab,
BDI_motor = Motor + Persever,
BDI_Nnonplan = SelfControl + CogCompl)
qs_final <- qs_demographic %>%
mutate(Attention = `5` + score_reverse(`9`) + `11` + score_reverse(`20`) + `28`,
CogInstab = `6`+`24`+`26`,
Motor = 	`2`+ `3` + `4` + `17` + `19` + `22` + `25`,
Persever = `16` + `21` + `23` + score_reverse(`30`),
SelfControl = score_reverse(`1`) + score_reverse(`7`) + score_reverse(`8`) + score_reverse(`12`) + score_reverse(`13`) + `14`,
CogCompl = score_reverse(`10`) + score_reverse(`15`) + `18` + `27` +  score_reverse(`29`)) %>%
mutate (BDI_attentional = Attention +CogInstab,
BDI_motor = Motor + Persever,
BDI_Nnonplan = SelfControl + CogCompl) %>%
select(-c(6:36))
write.csv(qs_final, file = "qs_Data.csv")
